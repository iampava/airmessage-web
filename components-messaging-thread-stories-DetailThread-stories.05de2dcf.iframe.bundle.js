"use strict";(self.webpackChunkairmessage_react=self.webpackChunkairmessage_react||[]).push([[3221],{"./node_modules/@mui/icons-material/esm/VideocamOutlined.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _utils_createSvgIcon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@mui/material/esm/utils/createSvgIcon.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__=(0,_utils_createSvgIcon__WEBPACK_IMPORTED_MODULE_1__.Z)((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path",{d:"M15 8v8H5V8h10m1-2H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4V7c0-.55-.45-1-1-1z"}),"VideocamOutlined")},"./node_modules/@mui/material/esm/Divider/Divider.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),clsx__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),_mui_base__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/utils/esm/composeClasses/composeClasses.js"),_mui_system__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@mui/system/esm/colorManipulator.js"),_styles_styled__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/esm/styles/styled.js"),_styles_useThemeProps__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@mui/material/esm/styles/useThemeProps.js"),_dividerClasses__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/Divider/dividerClasses.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const _excluded=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],DividerRoot=(0,_styles_styled__WEBPACK_IMPORTED_MODULE_4__.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,ownerState.absolute&&styles.absolute,styles[ownerState.variant],ownerState.light&&styles.light,"vertical"===ownerState.orientation&&styles.vertical,ownerState.flexItem&&styles.flexItem,ownerState.children&&styles.withChildren,ownerState.children&&"vertical"===ownerState.orientation&&styles.withChildrenVertical,"right"===ownerState.textAlign&&"vertical"!==ownerState.orientation&&styles.textAlignRight,"left"===ownerState.textAlign&&"vertical"!==ownerState.orientation&&styles.textAlignLeft]}})((({theme,ownerState})=>(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(theme.vars||theme).palette.divider,borderBottomWidth:"thin"},ownerState.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},ownerState.light&&{borderColor:theme.vars?`rgba(${theme.vars.palette.dividerChannel} / 0.08)`:(0,_mui_system__WEBPACK_IMPORTED_MODULE_6__.Fq)(theme.palette.divider,.08)},"inset"===ownerState.variant&&{marginLeft:72},"middle"===ownerState.variant&&"horizontal"===ownerState.orientation&&{marginLeft:theme.spacing(2),marginRight:theme.spacing(2)},"middle"===ownerState.variant&&"vertical"===ownerState.orientation&&{marginTop:theme.spacing(1),marginBottom:theme.spacing(1)},"vertical"===ownerState.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},ownerState.flexItem&&{alignSelf:"stretch",height:"auto"})),(({theme,ownerState})=>(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__.Z)({},ownerState.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${(theme.vars||theme).palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}})),(({theme,ownerState})=>(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__.Z)({},ownerState.children&&"vertical"===ownerState.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${(theme.vars||theme).palette.divider}`,transform:"translateX(0%)"}})),(({ownerState})=>(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__.Z)({},"right"===ownerState.textAlign&&"vertical"!==ownerState.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===ownerState.textAlign&&"vertical"!==ownerState.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}}))),DividerWrapper=(0,_styles_styled__WEBPACK_IMPORTED_MODULE_4__.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.wrapper,"vertical"===ownerState.orientation&&styles.wrapperVertical]}})((({theme,ownerState})=>(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__.Z)({display:"inline-block",paddingLeft:`calc(${theme.spacing(1)} * 1.2)`,paddingRight:`calc(${theme.spacing(1)} * 1.2)`},"vertical"===ownerState.orientation&&{paddingTop:`calc(${theme.spacing(1)} * 1.2)`,paddingBottom:`calc(${theme.spacing(1)} * 1.2)`}))),__WEBPACK_DEFAULT_EXPORT__=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function Divider(inProps,ref){const props=(0,_styles_useThemeProps__WEBPACK_IMPORTED_MODULE_7__.Z)({props:inProps,name:"MuiDivider"}),{absolute=!1,children,className,component=children?"div":"hr",flexItem=!1,light=!1,orientation="horizontal",role="hr"!==component?"separator":void 0,textAlign="center",variant="fullWidth"}=props,other=(0,_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_8__.Z)(props,_excluded),ownerState=(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__.Z)({},props,{absolute,component,flexItem,light,orientation,role,textAlign,variant}),classes=(ownerState=>{const{absolute,children,classes,flexItem,light,orientation,textAlign,variant}=ownerState,slots={root:["root",absolute&&"absolute",variant,light&&"light","vertical"===orientation&&"vertical",flexItem&&"flexItem",children&&"withChildren",children&&"vertical"===orientation&&"withChildrenVertical","right"===textAlign&&"vertical"!==orientation&&"textAlignRight","left"===textAlign&&"vertical"!==orientation&&"textAlignLeft"],wrapper:["wrapper","vertical"===orientation&&"wrapperVertical"]};return(0,_mui_base__WEBPACK_IMPORTED_MODULE_2__.Z)(slots,_dividerClasses__WEBPACK_IMPORTED_MODULE_3__.V,classes)})(ownerState);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DividerRoot,(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_5__.Z)({as:component,className:(0,clsx__WEBPACK_IMPORTED_MODULE_9__.Z)(classes.root,className),role,ref,ownerState},other,{children:children?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DividerWrapper,{className:classes.wrapper,ownerState,children}):null}))}))},"./node_modules/@mui/material/esm/Divider/dividerClasses.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{V:()=>getDividerUtilityClass,Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _mui_base__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@mui/utils/esm/generateUtilityClass/generateUtilityClass.js");function getDividerUtilityClass(slot){return(0,_mui_base__WEBPACK_IMPORTED_MODULE_0__.Z)("MuiDivider",slot)}const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("./node_modules/@mui/utils/esm/generateUtilityClasses/generateUtilityClasses.js").Z)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"])},"./src/components/messaging/thread/stories/DetailThread.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DetailThread:()=>DetailThread_stories_DetailThread,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DetailThread_stories});var react=__webpack_require__("./node_modules/react/index.js"),MessageList=__webpack_require__("./src/components/messaging/thread/MessageList.tsx"),Stack=__webpack_require__("./node_modules/@mui/material/esm/Stack/Stack.js"),CircularProgress=__webpack_require__("./node_modules/@mui/material/esm/CircularProgress/CircularProgress.js"),Typography=__webpack_require__("./node_modules/@mui/material/esm/Typography/Typography.js"),Button=__webpack_require__("./node_modules/@mui/material/esm/Button/Button.js"),Box=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),DetailFrame=__webpack_require__("./src/components/messaging/master/DetailFrame.tsx"),MessageInput=__webpack_require__("./src/components/messaging/thread/MessageInput.tsx"),hookUtils=__webpack_require__("./src/util/hookUtils.ts"),languageUtils=__webpack_require__("./src/util/languageUtils.ts"),connectionManager=__webpack_require__("./src/connection/connectionManager.ts"),conversationUtils=__webpack_require__("./src/util/conversationUtils.ts"),stateCodes=__webpack_require__("./src/data/stateCodes.ts");const message_out_namespaceObject=__webpack_require__.p+"static/media/message_out.d6e1251d.wav";var eventEmitter=__webpack_require__("./src/util/eventEmitter.ts");const state_localMessageCache=new Map;var cancellablePromise=__webpack_require__("./src/util/cancellablePromise.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function DetailThread({conversation}){const[displayState,setDisplayState]=(0,react.useState)({type:DisplayType.Loading}),[historyLoadState,setHistoryLoadState]=(0,react.useState)(HistoryLoadState.Idle),conversationTitle=(0,hookUtils.vU)(conversation),faceTimeSupported=(0,hookUtils.ZM)(),messageSubmitEmitter=(0,react.useRef)(new eventEmitter.Z),[messageInput,setMessageInput]=(0,react.useState)(""),[attachmentInput,setAttachmentInput]=(0,react.useState)([]),requestMessages=(0,react.useCallback)((()=>{conversation.localOnly?setDisplayState({type:DisplayType.Messages,messages:state_localMessageCache.get(conversation.localID)??[]}):(setDisplayState({type:DisplayType.Loading}),connectionManager.AN(conversation.guid).then((messages=>{setDisplayState({type:DisplayType.Messages,messages})})).catch((()=>{setDisplayState({type:DisplayType.Error})})))}),[conversation,setDisplayState]),loadedThreadMessages=(0,react.useRef)(void 0),requestHistoryUnsubscribeContainer=(0,hookUtils.b8)([conversation.localID]),requestHistory=(0,react.useCallback)((()=>{if(displayState.type!==DisplayType.Messages||conversation.localOnly||historyLoadState!==HistoryLoadState.Idle)return;setHistoryLoadState(HistoryLoadState.Loading);const displayStateMessages=displayState.messages;(0,cancellablePromise.e)(connectionManager.AN(conversation.guid,displayStateMessages[displayStateMessages.length-1].serverID),requestHistoryUnsubscribeContainer).then((messages=>{messages.length>0?(setHistoryLoadState(HistoryLoadState.Idle),setDisplayState((displayState=>displayState.type!==DisplayType.Messages?displayState:{type:DisplayType.Messages,messages:displayState.messages.concat(messages)}))):setHistoryLoadState(HistoryLoadState.Complete)})).catch((()=>{setHistoryLoadState(HistoryLoadState.Idle)}))}),[conversation,displayState,setDisplayState,historyLoadState,setHistoryLoadState,requestHistoryUnsubscribeContainer]);(0,react.useEffect)((()=>{loadedThreadMessages.current!==conversation.localID&&(requestMessages(),loadedThreadMessages.current=conversation.localID)}),[conversation.localID,requestMessages]);const handleMessageUpdate=(0,react.useCallback)((itemArray=>{setDisplayState((displayState=>{if(displayState.type!==DisplayType.Messages)return displayState;const pendingMessages=[...displayState.messages],newMessages=[];for(const newItem of itemArray){if(!(0,conversationUtils.kG)(conversation,newItem))continue;let itemMatched=!1;if(newItem.itemType===stateCodes.QN.Message){const matchedIndex=(0,conversationUtils.Z6)(pendingMessages,newItem);if(-1!==matchedIndex){const mergeTargetItem=pendingMessages[matchedIndex];pendingMessages[matchedIndex]={...mergeTargetItem,serverID:newItem.serverID,guid:newItem.guid,date:newItem.date,status:newItem.status,error:newItem.error,statusDate:newItem.statusDate},itemMatched=!0}}itemMatched||newMessages.push(newItem)}return pendingMessages.unshift(...newMessages),{type:DisplayType.Messages,messages:pendingMessages}}))}),[setDisplayState,conversation]);(0,react.useEffect)((()=>connectionManager.fY.subscribe(handleMessageUpdate)),[handleMessageUpdate]);const handleModifierUpdate=(0,react.useCallback)((itemArray=>{setDisplayState((displayState=>{if(displayState.type!==DisplayType.Messages)return displayState;const pendingItemArray=[...displayState.messages];for(const modifier of itemArray){const matchingIndex=pendingItemArray.findIndex((item=>item.itemType===stateCodes.QN.Message&&item.guid===modifier.messageGuid));if(-1===matchingIndex)continue;const matchedItem=pendingItemArray[matchingIndex];if((0,conversationUtils.hO)(modifier))pendingItemArray[matchingIndex]={...matchedItem,status:modifier.status,statusDate:modifier.date};else if((0,conversationUtils.NJ)(modifier))pendingItemArray[matchingIndex]={...matchedItem,stickers:matchedItem.stickers.concat(modifier)};else if((0,conversationUtils.HU)(modifier)){const pendingTapbacks=[...matchedItem.tapbacks],matchingTapbackIndex=pendingTapbacks.findIndex((tapback=>tapback.sender===modifier.sender));-1!==matchingTapbackIndex?pendingTapbacks[matchingTapbackIndex]=modifier:pendingTapbacks.push(modifier),pendingItemArray[matchingIndex]={...matchedItem,tapbacks:pendingTapbacks}}}return{type:DisplayType.Messages,messages:pendingItemArray}}))}),[setDisplayState]);(0,react.useEffect)((()=>connectionManager.JZ.subscribe(handleModifierUpdate)),[handleModifierUpdate]);const addAttachment=(0,react.useCallback)((files=>{setAttachmentInput((attachments=>[...attachments,...files.map((file=>({id:(0,conversationUtils.se)(),file})))]))}),[setAttachmentInput]),removeAttachment=(0,react.useCallback)((file=>{setAttachmentInput((attachments=>attachments.filter((queuedFile=>queuedFile.id!==file.id))))}),[setAttachmentInput]),uploadSubscriptionsContainer=(0,hookUtils.b8)([conversation.localID,displayState.type]),applyMessageError=(0,react.useCallback)(((localID,error)=>{setDisplayState((displayState=>{if(displayState.type!==DisplayType.Messages)return displayState;const pendingItems=[...displayState.messages],itemIndex=pendingItems.findIndex((item=>item.localID===localID));if(-1!==itemIndex){const message=pendingItems[itemIndex];pendingItems[itemIndex]={...message,error}}return{type:DisplayType.Messages,messages:pendingItems}}))}),[setDisplayState]),registerUploadProgress=(0,react.useCallback)(((messageID,uploadProgress)=>{const updateMessage=updater=>{setDisplayState((displayState=>{if(displayState.type!==DisplayType.Messages)return displayState;const pendingItems=[...displayState.messages],itemIndex=pendingItems.findIndex((item=>item.localID===messageID));if(-1===itemIndex)return displayState;const message=pendingItems[itemIndex];return pendingItems[itemIndex]={...message,...updater(message)},{type:DisplayType.Messages,messages:pendingItems}}))};uploadProgress.emitter.subscribe((progressData=>{updateMessage((message=>"number"==typeof progressData?{progress:progressData/message.attachments[0].size*100}:{attachments:[{...message.attachments[0],checksum:progressData}]}))}),uploadSubscriptionsContainer),(0,cancellablePromise.e)(uploadProgress.promise,uploadSubscriptionsContainer).then((()=>{updateMessage((()=>({progress:void 0})))})).catch((error=>applyMessageError(messageID,error)))}),[setDisplayState,applyMessageError,uploadSubscriptionsContainer]),submitInput=(0,react.useCallback)(((messageText,queuedFileArray)=>{if(displayState.type!==DisplayType.Messages)return;const conversationTarget=conversation.localOnly?{type:"unlinked",members:conversation.members,service:conversation.service}:{type:"linked",guid:conversation.guid},addedItems=[],trimmedMessageText=messageText.trim();if(""!==trimmedMessageText){const messageLocalID=(0,conversationUtils.Xf)(),message={itemType:stateCodes.QN.Message,localID:messageLocalID,serverID:void 0,guid:void 0,chatGuid:conversation.localOnly?void 0:conversation.guid,chatLocalID:conversation.localID,date:new Date,text:trimmedMessageText,subject:void 0,sender:void 0,attachments:[],stickers:[],tapbacks:[],sendStyle:void 0,status:stateCodes.Bu.Unconfirmed,error:void 0,statusDate:void 0};connectionManager.bG(conversationTarget,trimmedMessageText).catch((error=>applyMessageError(messageLocalID,error))),addedItems.push(message)}setMessageInput("");for(const queuedFile of queuedFileArray){const messageLocalID=(0,conversationUtils.Xf)(),message={itemType:stateCodes.QN.Message,localID:messageLocalID,serverID:void 0,guid:void 0,chatGuid:conversation.localOnly?void 0:conversation.guid,chatLocalID:conversation.localID,date:new Date,text:void 0,subject:void 0,sender:void 0,attachments:[{localID:queuedFile.id,name:queuedFile.file.name,type:queuedFile.file.type,size:queuedFile.file.size,data:queuedFile.file}],stickers:[],tapbacks:[],sendStyle:void 0,status:stateCodes.Bu.Unconfirmed,statusDate:void 0,error:void 0,progress:-1},progress=connectionManager.kB(conversationTarget,queuedFile.file);registerUploadProgress(messageLocalID,progress),addedItems.push(message)}setAttachmentInput([]),addedItems.length>0&&(connectionManager.fY.notify(addedItems),messageSubmitEmitter.current.notify(),function playSoundMessageOut(){new Audio(message_out_namespaceObject).play()?.catch((reason=>{console.log("Failed to play outgoing message audio: "+reason)}))}())}),[displayState,conversation,registerUploadProgress,setMessageInput,setAttachmentInput,applyMessageError]),startCall=(0,react.useCallback)((async()=>{await connectionManager.yY(conversation.members)}),[conversation]);let body;displayState.type===DisplayType.Messages?body=(0,jsx_runtime.jsx)(MessageList.Z,{conversation,items:displayState.messages,messageSubmitEmitter:messageSubmitEmitter.current,showHistoryLoader:historyLoadState===HistoryLoadState.Loading,onRequestHistory:requestHistory}):displayState.type===DisplayType.Loading?body=(0,jsx_runtime.jsx)(Stack.Z,{height:"100%",alignItems:"center",justifyContent:"center",children:(0,jsx_runtime.jsx)(CircularProgress.Z,{})}):displayState.type===DisplayType.Error&&(body=(0,jsx_runtime.jsxs)(Stack.Z,{height:"100%",alignItems:"center",justifyContent:"center",children:[(0,jsx_runtime.jsx)(Typography.Z,{color:"textSecondary",gutterBottom:!0,children:"Couldn't load this conversation"}),(0,jsx_runtime.jsx)(Button.Z,{onClick:requestMessages,children:"Retry"})]}));const cancelDrag=(0,react.useCallback)((event=>{event.preventDefault(),event.stopPropagation()}),[]),handleDragOver=(0,react.useCallback)((event=>{event.preventDefault(),event.stopPropagation(),event.dataTransfer&&(event.dataTransfer.dropEffect="copy")}),[]),handleDrop=(0,react.useCallback)((event=>{if(event.preventDefault(),event.stopPropagation(),!event.dataTransfer)return;const files=[...event.dataTransfer.files].map((file=>({id:(0,conversationUtils.se)(),file})));setAttachmentInput((attachmentInput=>attachmentInput.concat(...files)))}),[setAttachmentInput]);return(0,jsx_runtime.jsx)(DetailFrame.I,{title:conversationTitle,showCall:faceTimeSupported,onClickCall:startCall,children:(0,jsx_runtime.jsxs)(Stack.Z,{flexGrow:1,minHeight:0,onDragEnter:cancelDrag,onDragLeave:cancelDrag,onDragOver:handleDragOver,onDrop:handleDrop,children:[(0,jsx_runtime.jsx)(Stack.Z,{flexGrow:1,minHeight:0,children:body}),(0,jsx_runtime.jsx)(Box.Z,{width:"100%",padding:2,children:(0,jsx_runtime.jsx)(MessageInput.Z,{placeholder:(0,languageUtils.yj)(conversation.service),message:messageInput,onMessageChange:setMessageInput,attachments:attachmentInput,onAttachmentAdd:addAttachment,onAttachmentRemove:removeAttachment,onMessageSubmit:submitInput})})]})})}DetailThread.displayName="DetailThread";var DisplayType=function(DisplayType){return DisplayType[DisplayType.Loading=0]="Loading",DisplayType[DisplayType.Error=1]="Error",DisplayType[DisplayType.Messages=2]="Messages",DisplayType}(DisplayType||{}),HistoryLoadState=function(HistoryLoadState){return HistoryLoadState[HistoryLoadState.Idle=0]="Idle",HistoryLoadState[HistoryLoadState.Loading=1]="Loading",HistoryLoadState[HistoryLoadState.Complete=2]="Complete",HistoryLoadState}(HistoryLoadState||{});try{DetailThread.displayName="DetailThread",DetailThread.__docgenInfo={description:"",displayName:"DetailThread",props:{conversation:{defaultValue:null,description:"",name:"conversation",required:!0,type:{name:"Conversation"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/DetailThread.tsx#DetailThread"]={docgenInfo:DetailThread.__docgenInfo,name:"DetailThread",path:"src/components/messaging/thread/DetailThread.tsx#DetailThread"})}catch(__react_docgen_typescript_loader_error){}const DetailThread_stories={title:"components/messaging/thread",component:DetailThread},DetailThread_stories_DetailThread={args:{conversation:{guid:"guid",localID:123,localOnly:!1,unreadMessages:!0,service:"iMessage",preview:{date:new Date,attachments:[],type:stateCodes.mZ.Message},members:["Jon Doe","Bill Smith"]}}};DetailThread_stories_DetailThread.parameters={...DetailThread_stories_DetailThread.parameters,docs:{...DetailThread_stories_DetailThread.parameters?.docs,source:{originalSource:'{\n  args: {\n    conversation: {\n      guid: "guid",\n      localID: 123,\n      localOnly: false,\n      unreadMessages: true,\n      service: "iMessage",\n      preview: {\n        date: new Date(),\n        attachments: [],\n        type: ConversationPreviewType.Message\n      },\n      members: ["Jon Doe", "Bill Smith"]\n    }\n  }\n}',...DetailThread_stories_DetailThread.parameters?.docs?.source}}};const __namedExportsOrder=["DetailThread"]},"./src/components/icon/BorderedCloseIcon.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>BorderedCloseIcon});__webpack_require__("./node_modules/react/index.js");var _mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/SvgIcon/SvgIcon.js"),_mui_material_styles__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/styles/useTheme.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function BorderedCloseIcon(props){const theme=(0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_2__.Z)(),colorBackground="light"===theme.palette.mode?theme.palette.grey[700]:theme.palette.grey[300],colorSymbol="light"===theme.palette.mode?theme.palette.grey[200]:theme.palette.grey[700];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{...props,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("circle",{cx:"12",cy:"12",r:"8",fill:colorBackground}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"M12,2 C6.47,2 2,6.47 2,12 C2,17.53 6.47,22 12,22 C17.53,22 22,17.53 22,12 C22,6.47 17.53,2 12,2 Z M12,20 C7.59,20 4,16.41 4,12 C4,7.59 7.59,4 12,4 C16.41,4 20,7.59 20,12 C20,16.41 16.41,20 12,20 Z",fill:theme.palette.messageIncoming.main}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"M13.89,8.7 L12,10.59 L10.11,8.7 C9.72,8.31 9.09,8.31 8.7,8.7 C8.31,9.09 8.31,9.72 8.7,10.11 L10.59,12 L8.7,13.89 C8.31,14.28 8.31,14.91 8.7,15.3 C9.09,15.69 9.72,15.69 10.11,15.3 L12,13.41 L13.89,15.3 C14.28,15.69 14.91,15.69 15.3,15.3 C15.69,14.91 15.69,14.28 15.3,13.89 L13.41,12 L15.3,10.11 C15.69,9.72 15.69,9.09 15.3,8.7 C14.91,8.32 14.27,8.32 13.89,8.7 Z",fill:colorSymbol})]})}BorderedCloseIcon.displayName="BorderedCloseIcon";try{BorderedCloseIcon.displayName="BorderedCloseIcon",BorderedCloseIcon.__docgenInfo={description:"",displayName:"BorderedCloseIcon",props:{children:{defaultValue:null,description:"Node passed into the SVG element.",name:"children",required:!1,type:{name:"ReactNode"}},classes:{defaultValue:null,description:"Override or extend the styles applied to the component.",name:"classes",required:!1,type:{name:"(Partial<SvgIconClasses> & Partial<ClassNameMap<never>>)"}},color:{defaultValue:{value:"'inherit'"},description:"The color of the component.\nIt supports both default and custom theme colors, which can be added as shown in the\n[palette customization guide](https://mui.com/material-ui/customization/palette/#adding-new-colors).\nYou can use the `htmlColor` prop to apply a color attribute to the SVG element.",name:"color",required:!1,type:{name:"enum",value:[{value:'"action"'},{value:'"error"'},{value:'"inherit"'},{value:'"disabled"'},{value:'"primary"'},{value:'"secondary"'},{value:'"info"'},{value:'"success"'},{value:'"warning"'}]}},fontSize:{defaultValue:{value:"'medium'"},description:"The fontSize applied to the icon. Defaults to 24px, but can be configure to inherit font size.",name:"fontSize",required:!1,type:{name:"enum",value:[{value:'"small"'},{value:'"inherit"'},{value:'"large"'},{value:'"medium"'}]}},htmlColor:{defaultValue:null,description:"Applies a color attribute to the SVG element.",name:"htmlColor",required:!1,type:{name:"string"}},inheritViewBox:{defaultValue:{value:"false"},description:"If `true`, the root node will inherit the custom `component`'s viewBox and the `viewBox`\nprop will be ignored.\nUseful when you want to reference a custom `component` and have `SvgIcon` pass that\n`component`'s viewBox to the root node.",name:"inheritViewBox",required:!1,type:{name:"boolean"}},shapeRendering:{defaultValue:null,description:"The shape-rendering attribute. The behavior of the different options is described on the\n[MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/shape-rendering).\nIf you are having issues with blurry icons you should investigate this prop.",name:"shapeRendering",required:!1,type:{name:"string"}},sx:{defaultValue:null,description:"The system prop that allows defining system overrides as well as additional CSS styles.",name:"sx",required:!1,type:{name:"SxProps<Theme>"}},titleAccess:{defaultValue:null,description:"Provides a human-readable title for the element that contains it.\nhttps://www.w3.org/TR/SVG-access/#Equivalent",name:"titleAccess",required:!1,type:{name:"string"}},viewBox:{defaultValue:{value:"'0 0 24 24'"},description:'Allows you to redefine what the coordinates without units mean inside an SVG element.\nFor example, if the SVG element is 500 (width) by 200 (height),\nand you pass viewBox="0 0 50 20",\nthis means that the coordinates inside the SVG will go from the top left corner (0,0)\nto bottom right (50,20) and each unit will be worth 10px.',name:"viewBox",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: SVGSVGElement | null) => void) | RefObject<SVGSVGElement> | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icon/BorderedCloseIcon.tsx#BorderedCloseIcon"]={docgenInfo:BorderedCloseIcon.__docgenInfo,name:"BorderedCloseIcon",path:"src/components/icon/BorderedCloseIcon.tsx#BorderedCloseIcon"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/icon/PushIcon.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>PushIcon});__webpack_require__("./node_modules/react/index.js");var _mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/SvgIcon/SvgIcon.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function PushIcon(props){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_2__.Z,{...props,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"M12,22C9.3478,22 6.8043,20.9464 4.9289,19.0711C3.0536,17.1957 2,14.6522 2,12C2,9.3478 3.0536,6.8043 4.9289,4.9289C6.8043,3.0536 9.3478,2 12,2C14.6522,2 17.1957,3.0536 19.0711,4.9289C20.9464,6.8043 22,9.3478 22,12C22,17.5228 17.5228,22 12,22ZM13,17C13,16.6667 13,14.1667 13,9.5L15.7929,12.2929C16.1834,12.6834 16.8166,12.6834 17.2071,12.2929L17.21,12.29L17.2129,12.2871C17.6034,11.8966 17.6034,11.2634 17.2129,10.8729L12.7071,6.3671C12.3166,5.9766 11.6834,5.9766 11.2929,6.3671L6.7871,10.8729C6.3966,11.2634 6.3966,11.8966 6.7871,12.2871L6.7929,12.2929C7.1834,12.6834 7.8166,12.6834 8.2071,12.2929L11,9.5C11,14.1667 11,16.6667 11,17C11,17.5 11.5,18 12,18C12.5,18 13,17.5 13,17Z"})})}PushIcon.displayName="PushIcon";try{PushIcon.displayName="PushIcon",PushIcon.__docgenInfo={description:"",displayName:"PushIcon",props:{children:{defaultValue:null,description:"Node passed into the SVG element.",name:"children",required:!1,type:{name:"ReactNode"}},classes:{defaultValue:null,description:"Override or extend the styles applied to the component.",name:"classes",required:!1,type:{name:"(Partial<SvgIconClasses> & Partial<ClassNameMap<never>>)"}},color:{defaultValue:{value:"'inherit'"},description:"The color of the component.\nIt supports both default and custom theme colors, which can be added as shown in the\n[palette customization guide](https://mui.com/material-ui/customization/palette/#adding-new-colors).\nYou can use the `htmlColor` prop to apply a color attribute to the SVG element.",name:"color",required:!1,type:{name:"enum",value:[{value:'"action"'},{value:'"error"'},{value:'"inherit"'},{value:'"disabled"'},{value:'"primary"'},{value:'"secondary"'},{value:'"info"'},{value:'"success"'},{value:'"warning"'}]}},fontSize:{defaultValue:{value:"'medium'"},description:"The fontSize applied to the icon. Defaults to 24px, but can be configure to inherit font size.",name:"fontSize",required:!1,type:{name:"enum",value:[{value:'"small"'},{value:'"inherit"'},{value:'"large"'},{value:'"medium"'}]}},htmlColor:{defaultValue:null,description:"Applies a color attribute to the SVG element.",name:"htmlColor",required:!1,type:{name:"string"}},inheritViewBox:{defaultValue:{value:"false"},description:"If `true`, the root node will inherit the custom `component`'s viewBox and the `viewBox`\nprop will be ignored.\nUseful when you want to reference a custom `component` and have `SvgIcon` pass that\n`component`'s viewBox to the root node.",name:"inheritViewBox",required:!1,type:{name:"boolean"}},shapeRendering:{defaultValue:null,description:"The shape-rendering attribute. The behavior of the different options is described on the\n[MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/shape-rendering).\nIf you are having issues with blurry icons you should investigate this prop.",name:"shapeRendering",required:!1,type:{name:"string"}},sx:{defaultValue:null,description:"The system prop that allows defining system overrides as well as additional CSS styles.",name:"sx",required:!1,type:{name:"SxProps<Theme>"}},titleAccess:{defaultValue:null,description:"Provides a human-readable title for the element that contains it.\nhttps://www.w3.org/TR/SVG-access/#Equivalent",name:"titleAccess",required:!1,type:{name:"string"}},viewBox:{defaultValue:{value:"'0 0 24 24'"},description:'Allows you to redefine what the coordinates without units mean inside an SVG element.\nFor example, if the SVG element is 500 (width) by 200 (height),\nand you pass viewBox="0 0 50 20",\nthis means that the coordinates inside the SVG will go from the top left corner (0,0)\nto bottom right (50,20) and each unit will be worth 10px.',name:"viewBox",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: SVGSVGElement | null) => void) | RefObject<SVGSVGElement> | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icon/PushIcon.tsx#PushIcon"]={docgenInfo:PushIcon.__docgenInfo,name:"PushIcon",path:"src/components/icon/PushIcon.tsx#PushIcon"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/master/DetailFrame.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>DetailFrame});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/Stack/Stack.js"),_mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/Toolbar/Toolbar.js"),_mui_material__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/esm/Typography/Typography.js"),_mui_material__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),_mui_material__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@mui/material/esm/Divider/Divider.js"),_mui_icons_material__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@mui/icons-material/esm/VideocamOutlined.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const DetailFrame=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(((props,ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_2__.Z,{height:"100%",ref,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_4__.Z,{flexGrow:1,flexShrink:1,flexBasis:0,variant:"h6",noWrap:!0,children:props.title}),props.showCall&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_5__.Z,{size:"large",onClick:props.onClickCall,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_icons_material__WEBPACK_IMPORTED_MODULE_6__.Z,{})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Z,{}),props.children]})));try{DetailFrame.displayName="DetailFrame",DetailFrame.__docgenInfo={description:"A frame component with a toolbar, used to wrap detail views",displayName:"DetailFrame",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},showCall:{defaultValue:null,description:"",name:"showCall",required:!1,type:{name:"boolean"}},onClickCall:{defaultValue:null,description:"",name:"onClickCall",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/master/DetailFrame.tsx#DetailFrame"]={docgenInfo:DetailFrame.__docgenInfo,name:"DetailFrame",path:"src/components/messaging/master/DetailFrame.tsx#DetailFrame"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/MessageInput.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>MessageInput});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),_mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/Stack/Stack.js"),_mui_material__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@mui/material/esm/InputBase/InputBase.js"),_mui_material__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),_icon_PushIcon__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/components/icon/PushIcon.tsx"),_queue_QueuedAttachmentImage__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/messaging/thread/queue/QueuedAttachmentImage.tsx"),_queue_QueuedAttachmentGeneric__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/messaging/thread/queue/QueuedAttachmentGeneric.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function MessageInput(props){const{onMessageChange:propsOnMessageChange,onMessageSubmit:propsOnMessageSubmit,message:propsMessage,attachments:propsAttachments,onAttachmentAdd:propsOnAttachmentAdd}=props,handleChange=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((event=>{propsOnMessageChange(event.target.value)}),[propsOnMessageChange]),submitInput=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{propsOnMessageSubmit(propsMessage,propsAttachments)}),[propsOnMessageSubmit,propsMessage,propsAttachments]),handleKeyDown=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((event=>{event.shiftKey||"Enter"!==event.key||(event.preventDefault(),submitInput())}),[submitInput]),handlePaste=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((event=>{propsOnAttachmentAdd(Array.from(event.clipboardData.files))}),[propsOnAttachmentAdd]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_2__.Z,{sx:{borderRadius:5,backgroundColor:"messageIncoming.main",overflow:"hidden",maxWidth:1e3,marginX:"auto"},children:[props.attachments.length>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{sx:{overflowX:"scroll",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},paddingX:"16px",paddingTop:"16px"},direction:"row",gap:2,children:props.attachments.map((file=>{const queueData={file:file.file,onRemove:()=>props.onAttachmentRemove(file)};let component;return component=file.file.type.startsWith("image/")?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_queue_QueuedAttachmentImage__WEBPACK_IMPORTED_MODULE_4__.H,{queueData},file.id):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_queue_QueuedAttachmentGeneric__WEBPACK_IMPORTED_MODULE_5__.Z,{queueData},file.id),component}))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{direction:"row",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_6__.ZP,{sx:{typography:"body2",paddingX:"16px",paddingY:"10px"},maxRows:"5",multiline:!0,fullWidth:!0,autoFocus:!0,placeholder:props.placeholder,value:props.message,onChange:handleChange,onKeyDown:handleKeyDown,onPaste:handlePaste}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Z,{sx:{width:"40px",height:"40px",flexShrink:0,alignSelf:"flex-end"},size:"small",color:"primary",disabled:""===props.message.trim()&&0===props.attachments.length,onClick:submitInput,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_icon_PushIcon__WEBPACK_IMPORTED_MODULE_8__.Z,{})})]})]})}MessageInput.displayName="MessageInput";try{MessageInput.displayName="MessageInput",MessageInput.__docgenInfo={description:"",displayName:"MessageInput",props:{placeholder:{defaultValue:null,description:"",name:"placeholder",required:!0,type:{name:"string"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"string"}},attachments:{defaultValue:null,description:"",name:"attachments",required:!0,type:{name:"QueuedFile[]"}},onMessageChange:{defaultValue:null,description:"",name:"onMessageChange",required:!0,type:{name:"(value: string) => void"}},onMessageSubmit:{defaultValue:null,description:"",name:"onMessageSubmit",required:!0,type:{name:"(message: string, attachments: QueuedFile[]) => void"}},onAttachmentAdd:{defaultValue:null,description:"",name:"onAttachmentAdd",required:!0,type:{name:"(files: File[]) => void"}},onAttachmentRemove:{defaultValue:null,description:"",name:"onAttachmentRemove",required:!0,type:{name:"(value: QueuedFile) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/MessageInput.tsx#MessageInput"]={docgenInfo:MessageInput.__docgenInfo,name:"MessageInput",path:"src/components/messaging/thread/MessageInput.tsx#MessageInput"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/MessageList.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>MessageList});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),_mui_material__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/esm/Stack/Stack.js"),_mui_material__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@mui/material/esm/CircularProgress/CircularProgress.js"),_item_Message__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/messaging/thread/item/Message.tsx"),_util_conversationUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/util/conversationUtils.ts"),_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/data/stateCodes.ts"),_item_ConversationActionParticipant__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/components/messaging/thread/item/ConversationActionParticipant.tsx"),_item_ConversationActionRename__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/components/messaging/thread/item/ConversationActionRename.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");class MessageList extends react__WEBPACK_IMPORTED_MODULE_0__.Component{state={isInThreshold:!1};scrollRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef();snapshotScrollHeight=0;snapshotScrollTop=0;shouldScrollNextUpdate=!1;handleScroll=event=>{event.currentTarget.scrollTop<300?this.state.isInThreshold||(this.setState({isInThreshold:!0}),this.props.onRequestHistory()):this.state.isInThreshold&&this.setState({isInThreshold:!1})};render(){const readTargetIndex=this.props.items.findIndex((item=>item.itemType===_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__.QN.Message&&void 0===item.sender&&item.status===_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__.Bu.Read)),deliveredTargetIndex=this.props.items.slice(0,-1===readTargetIndex?void 0:readTargetIndex).findIndex((item=>item.itemType===_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__.QN.Message&&void 0===item.sender&&item.status===_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__.Bu.Delivered));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{sx:{width:"100%",flexGrow:1,minHeight:0,padding:2,overflowX:"hidden",overflowY:"scroll",scrollBehavior:"smooth"},ref:this.scrollRef,onScroll:this.handleScroll,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_4__.Z,{sx:{width:"100%",maxWidth:"1000px",marginX:"auto"},direction:"column-reverse",children:[this.props.items.map(((item,i,array)=>item.itemType===_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__.QN.Message?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_item_Message__WEBPACK_IMPORTED_MODULE_5__.Z,{message:item,isGroupChat:this.props.conversation.members.length>1,service:this.props.conversation.service,flow:(0,_util_conversationUtils__WEBPACK_IMPORTED_MODULE_6__.If)(item,array[i+1],array[i-1]),showStatus:i===readTargetIndex||i===deliveredTargetIndex},item.localID??item.guid):item.itemType===_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__.QN.ParticipantAction?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_item_ConversationActionParticipant__WEBPACK_IMPORTED_MODULE_7__.Z,{action:item},item.localID??item.guid):item.itemType===_data_stateCodes__WEBPACK_IMPORTED_MODULE_2__.QN.ChatRenameAction?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_item_ConversationActionRename__WEBPACK_IMPORTED_MODULE_8__.Z,{action:item},item.localID??item.guid):null)),this.props.showHistoryLoader&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(HistoryLoadingProgress,{},"static-historyloader")]})})}componentDidMount(){this.props.messageSubmitEmitter.subscribe(this.onMessageSubmit),this.scrollToBottom(!0)}getSnapshotBeforeUpdate(){this.shouldScrollNextUpdate=this.checkScrolledToBottom();const element=this.scrollRef.current;return this.snapshotScrollHeight=element.scrollHeight,this.snapshotScrollTop=element.scrollTop,null}componentDidUpdate(prevProps){if(this.shouldScrollNextUpdate)this.scrollToBottom(),this.shouldScrollNextUpdate=!1;else if(this.props.showHistoryLoader!==prevProps.showHistoryLoader&&this.checkScrolledToTop()){const element=this.scrollRef.current;this.setScroll(this.snapshotScrollTop+(element.scrollHeight-this.snapshotScrollHeight),!0)}this.props.messageSubmitEmitter!==prevProps.messageSubmitEmitter&&(prevProps.messageSubmitEmitter.unsubscribe(this.onMessageSubmit),this.props.messageSubmitEmitter.subscribe(this.onMessageSubmit))}componentWillUnmount(){this.props.messageSubmitEmitter.unsubscribe(this.onMessageSubmit)}onMessageSubmit=()=>{setTimeout((()=>this.scrollToBottom()),0)};scrollToBottom(disableAnimation=!1){this.setScroll(this.scrollRef.current.scrollHeight,disableAnimation)}setScroll(scrollTop,disableAnimation=!1){const element=this.scrollRef.current;disableAnimation&&(element.style.scrollBehavior="auto"),element.scrollTop=scrollTop,disableAnimation&&(element.style.scrollBehavior="")}checkScrolledToBottom(){const element=this.scrollRef.current;return element.scrollHeight-element.scrollTop-element.clientHeight<=0}checkScrolledToTop(){return this.scrollRef.current.scrollTop<=0}}function HistoryLoadingProgress(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_9__.Z,{})})}MessageList.displayName="MessageList",HistoryLoadingProgress.displayName="HistoryLoadingProgress";try{MessageList.displayName="MessageList",MessageList.__docgenInfo={description:"",displayName:"MessageList",props:{conversation:{defaultValue:null,description:"",name:"conversation",required:!0,type:{name:"Conversation"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ConversationItem[]"}},messageSubmitEmitter:{defaultValue:null,description:"",name:"messageSubmitEmitter",required:!0,type:{name:"EventEmitter<void>"}},onRequestHistory:{defaultValue:null,description:"",name:"onRequestHistory",required:!0,type:{name:"() => void"}},showHistoryLoader:{defaultValue:null,description:"",name:"showHistoryLoader",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/MessageList.tsx#MessageList"]={docgenInfo:MessageList.__docgenInfo,name:"MessageList",path:"src/components/messaging/thread/MessageList.tsx#MessageList"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/item/ConversationActionLine.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>ConversationActionLine});__webpack_require__("./node_modules/react/index.js");var _mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/Typography/Typography.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ConversationActionLine(props){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_2__.Z,{paddingTop:3,paddingBottom:1,paddingX:1,textAlign:"center",variant:"body2",color:"textSecondary",children:props.children})}ConversationActionLine.displayName="ConversationActionLine";try{ConversationActionLine.displayName="ConversationActionLine",ConversationActionLine.__docgenInfo={description:"",displayName:"ConversationActionLine",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/item/ConversationActionLine.tsx#ConversationActionLine"]={docgenInfo:ConversationActionLine.__docgenInfo,name:"ConversationActionLine",path:"src/components/messaging/thread/item/ConversationActionLine.tsx#ConversationActionLine"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/item/ConversationActionParticipant.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>ConversationActionParticipant});__webpack_require__("./node_modules/react/index.js");var _data_stateCodes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/data/stateCodes.ts"),_ConversationActionLine__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/messaging/thread/item/ConversationActionLine.tsx"),shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/util/hookUtils.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ConversationActionParticipant(props){const userName=(0,shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_2__.em)(props.action.user),targetName=(0,shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_2__.em)(props.action.target);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_ConversationActionLine__WEBPACK_IMPORTED_MODULE_3__.Z,{children:generateMessage(props.action.type,userName,targetName)})}function generateMessage(type,user,target){if(type===_data_stateCodes__WEBPACK_IMPORTED_MODULE_4__.rk.Join){if(user===target)return user?`${user} joined the conversation`:"You joined the conversation";if(user&&target)return`${user} added ${target} to the conversation`;if(user)return`${user} added you to the conversation`;if(target)return`You added ${target} to the conversation`}else if(type===_data_stateCodes__WEBPACK_IMPORTED_MODULE_4__.rk.Leave){if(user===target)return user?`${user} left the conversation`:"You left the conversation";if(user&&target)return`${user} removed ${target} from the conversation`;if(user)return`${user} removed you from the conversation`;if(target)return`You removed ${target} from the conversation`}return"Unknown event"}ConversationActionParticipant.displayName="ConversationActionParticipant";try{ConversationActionParticipant.displayName="ConversationActionParticipant",ConversationActionParticipant.__docgenInfo={description:"",displayName:"ConversationActionParticipant",props:{action:{defaultValue:null,description:"",name:"action",required:!0,type:{name:"ParticipantAction"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/item/ConversationActionParticipant.tsx#ConversationActionParticipant"]={docgenInfo:ConversationActionParticipant.__docgenInfo,name:"ConversationActionParticipant",path:"src/components/messaging/thread/item/ConversationActionParticipant.tsx#ConversationActionParticipant"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/item/ConversationActionRename.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>ConversationActionRename});__webpack_require__("./node_modules/react/index.js");var _ConversationActionLine__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/messaging/thread/item/ConversationActionLine.tsx"),shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/util/hookUtils.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ConversationActionRename(props){const userName=(0,shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_2__.em)(props.action.user);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_ConversationActionLine__WEBPACK_IMPORTED_MODULE_3__.Z,{children:generateMessage(userName,props.action.chatName)})}function generateMessage(user,title){return user?title?`${user} named the conversation "${title}"`:`${user} removed the conversation name`:title?`You named the conversation "${title}"`:"You removed the conversation name"}ConversationActionRename.displayName="ConversationActionRename";try{ConversationActionRename.displayName="ConversationActionRename",ConversationActionRename.__docgenInfo={description:"",displayName:"ConversationActionRename",props:{action:{defaultValue:null,description:"",name:"action",required:!0,type:{name:"ChatRenameAction"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/item/ConversationActionRename.tsx#ConversationActionRename"]={docgenInfo:ConversationActionRename.__docgenInfo,name:"ConversationActionRename",path:"src/components/messaging/thread/item/ConversationActionRename.tsx#ConversationActionRename"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/queue/QueuedAttachment.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>QueuedAttachment});__webpack_require__("./node_modules/react/index.js");var _icon_BorderedCloseIcon__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/icon/BorderedCloseIcon.tsx"),_mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/Tooltip/Tooltip.js"),_mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),_mui_material__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function QueuedAttachment(props){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_2__.Z,{title:props.queueData.file.name,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{sx:{width:64,height:64,position:"relative"},children:[props.children,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_4__.Z,{sx:{position:"absolute",top:0,right:0,transform:"translate(50%, -50%)"},onClick:props.queueData.onRemove,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_icon_BorderedCloseIcon__WEBPACK_IMPORTED_MODULE_5__.Z,{})})]})})}QueuedAttachment.displayName="QueuedAttachment";try{QueuedAttachment.displayName="QueuedAttachment",QueuedAttachment.__docgenInfo={description:"",displayName:"QueuedAttachment",props:{queueData:{defaultValue:null,description:"",name:"queueData",required:!0,type:{name:"QueuedAttachmentProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/queue/QueuedAttachment.tsx#QueuedAttachment"]={docgenInfo:QueuedAttachment.__docgenInfo,name:"QueuedAttachment",path:"src/components/messaging/thread/queue/QueuedAttachment.tsx#QueuedAttachment"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/queue/QueuedAttachmentGeneric.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>QueuedAttachmentGeneric});__webpack_require__("./node_modules/react/index.js");var createSvgIcon=__webpack_require__("./node_modules/@mui/material/esm/utils/createSvgIcon.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const InsertDriveFileRounded=(0,createSvgIcon.Z)((0,jsx_runtime.jsx)("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59H6zm7 6V3.5L18.5 9H14c-.55 0-1-.45-1-1z"}),"InsertDriveFileRounded");var QueuedAttachment=__webpack_require__("./src/components/messaging/thread/queue/QueuedAttachment.tsx"),Box=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js");function QueuedAttachmentGeneric(props){return(0,jsx_runtime.jsx)(QueuedAttachment.Z,{queueData:props.queueData,children:(0,jsx_runtime.jsx)(Box.Z,{sx:{width:"100%",height:"100%",borderRadius:1,backgroundColor:"background.default",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,jsx_runtime.jsx)(InsertDriveFileRounded,{})})})}QueuedAttachmentGeneric.displayName="QueuedAttachmentGeneric";try{QueuedAttachmentGeneric.displayName="QueuedAttachmentGeneric",QueuedAttachmentGeneric.__docgenInfo={description:"",displayName:"QueuedAttachmentGeneric",props:{queueData:{defaultValue:null,description:"",name:"queueData",required:!0,type:{name:"QueuedAttachmentProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/queue/QueuedAttachmentGeneric.tsx#QueuedAttachmentGeneric"]={docgenInfo:QueuedAttachmentGeneric.__docgenInfo,name:"QueuedAttachmentGeneric",path:"src/components/messaging/thread/queue/QueuedAttachmentGeneric.tsx#QueuedAttachmentGeneric"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/queue/QueuedAttachmentImage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>QueuedAttachmentImage});__webpack_require__("./node_modules/react/index.js");var _QueuedAttachment__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/messaging/thread/queue/QueuedAttachment.tsx"),shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/util/hookUtils.ts"),_mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/styles/styled.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const AttachmentImage=(0,_mui_material__WEBPACK_IMPORTED_MODULE_2__.ZP)("img")((({theme})=>({width:"100%",height:"100%",objectFit:"cover",borderRadius:theme.shape.borderRadius})));function QueuedAttachmentImage(props){const imageURL=(0,shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_3__.vf)(props.queueData.file,props.queueData.file.type);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_QueuedAttachment__WEBPACK_IMPORTED_MODULE_4__.Z,{queueData:props.queueData,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AttachmentImage,{src:imageURL,alt:""})})}QueuedAttachmentImage.displayName="QueuedAttachmentImage";try{QueuedAttachmentImage.displayName="QueuedAttachmentImage",QueuedAttachmentImage.__docgenInfo={description:"",displayName:"QueuedAttachmentImage",props:{queueData:{defaultValue:null,description:"",name:"queueData",required:!0,type:{name:"QueuedAttachmentProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/queue/QueuedAttachmentImage.tsx#QueuedAttachmentImage"]={docgenInfo:QueuedAttachmentImage.__docgenInfo,name:"QueuedAttachmentImage",path:"src/components/messaging/thread/queue/QueuedAttachmentImage.tsx#QueuedAttachmentImage"})}catch(__react_docgen_typescript_loader_error){}}}]);