"use strict";(self.webpackChunkairmessage_react=self.webpackChunkairmessage_react||[]).push([[3515],{"./node_modules/@mui/material/esm/Box/Box.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Box_Box});var esm_extends=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),react=__webpack_require__("./node_modules/react/index.js"),clsx_m=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),styled_engine=__webpack_require__("./node_modules/@mui/styled-engine/index.js"),styleFunctionSx_styleFunctionSx=__webpack_require__("./node_modules/@mui/system/esm/styleFunctionSx/styleFunctionSx.js"),extendSxProp=__webpack_require__("./node_modules/@mui/system/esm/styleFunctionSx/extendSxProp.js"),useTheme=__webpack_require__("./node_modules/@mui/system/esm/useTheme.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const _excluded=["className","component"];var ClassNameGenerator=__webpack_require__("./node_modules/@mui/utils/esm/ClassNameGenerator/ClassNameGenerator.js");const Box=function createBox(options={}){const{defaultTheme,defaultClassName="MuiBox-root",generateClassName,styleFunctionSx=styleFunctionSx_styleFunctionSx.Z}=options,BoxRoot=(0,styled_engine.ZP)("div",{shouldForwardProp:prop=>"theme"!==prop&&"sx"!==prop&&"as"!==prop})(styleFunctionSx);return react.forwardRef((function Box(inProps,ref){const theme=(0,useTheme.Z)(defaultTheme),_extendSxProp=(0,extendSxProp.Z)(inProps),{className,component="div"}=_extendSxProp,other=(0,objectWithoutPropertiesLoose.Z)(_extendSxProp,_excluded);return(0,jsx_runtime.jsx)(BoxRoot,(0,esm_extends.Z)({as:component,ref,className:(0,clsx_m.Z)(className,generateClassName?generateClassName(defaultClassName):defaultClassName),theme},other))}))}({defaultTheme:(0,__webpack_require__("./node_modules/@mui/material/esm/styles/createTheme.js").Z)(),defaultClassName:"MuiBox-root",generateClassName:ClassNameGenerator.Z.generate}),Box_Box=Box},"./node_modules/@mui/material/esm/IconButton/IconButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>IconButton_IconButton});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/react/index.js"),clsx_m=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),composeClasses=__webpack_require__("./node_modules/@mui/utils/esm/composeClasses/composeClasses.js"),colorManipulator=__webpack_require__("./node_modules/@mui/system/esm/colorManipulator.js"),styled=__webpack_require__("./node_modules/@mui/material/esm/styles/styled.js"),useThemeProps=__webpack_require__("./node_modules/@mui/material/esm/styles/useThemeProps.js"),ButtonBase=__webpack_require__("./node_modules/@mui/material/esm/ButtonBase/ButtonBase.js"),capitalize=__webpack_require__("./node_modules/@mui/material/esm/utils/capitalize.js"),generateUtilityClass=__webpack_require__("./node_modules/@mui/utils/esm/generateUtilityClass/generateUtilityClass.js");function getIconButtonUtilityClass(slot){return(0,generateUtilityClass.Z)("MuiIconButton",slot)}const IconButton_iconButtonClasses=(0,__webpack_require__("./node_modules/@mui/utils/esm/generateUtilityClasses/generateUtilityClasses.js").Z)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]);var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const _excluded=["edge","children","className","color","disabled","disableFocusRipple","size"],IconButtonRoot=(0,styled.ZP)(ButtonBase.Z,{name:"MuiIconButton",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,"default"!==ownerState.color&&styles[`color${(0,capitalize.Z)(ownerState.color)}`],ownerState.edge&&styles[`edge${(0,capitalize.Z)(ownerState.edge)}`],styles[`size${(0,capitalize.Z)(ownerState.size)}`]]}})((({theme,ownerState})=>(0,esm_extends.Z)({textAlign:"center",flex:"0 0 auto",fontSize:theme.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(theme.vars||theme).palette.action.active,transition:theme.transitions.create("background-color",{duration:theme.transitions.duration.shortest})},!ownerState.disableRipple&&{"&:hover":{backgroundColor:theme.vars?`rgba(${theme.vars.palette.action.activeChannel} / ${theme.vars.palette.action.hoverOpacity})`:(0,colorManipulator.Fq)(theme.palette.action.active,theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===ownerState.edge&&{marginLeft:"small"===ownerState.size?-3:-12},"end"===ownerState.edge&&{marginRight:"small"===ownerState.size?-3:-12})),(({theme,ownerState})=>(0,esm_extends.Z)({},"inherit"===ownerState.color&&{color:"inherit"},"inherit"!==ownerState.color&&"default"!==ownerState.color&&(0,esm_extends.Z)({color:(theme.vars||theme).palette[ownerState.color].main},!ownerState.disableRipple&&{"&:hover":{backgroundColor:theme.vars?`rgba(${theme.vars.palette[ownerState.color].mainChannel} / ${theme.vars.palette.action.hoverOpacity})`:(0,colorManipulator.Fq)(theme.palette[ownerState.color].main,theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}),"small"===ownerState.size&&{padding:5,fontSize:theme.typography.pxToRem(18)},"large"===ownerState.size&&{padding:12,fontSize:theme.typography.pxToRem(28)},{[`&.${IconButton_iconButtonClasses.disabled}`]:{backgroundColor:"transparent",color:(theme.vars||theme).palette.action.disabled}}))),IconButton_IconButton=react.forwardRef((function IconButton(inProps,ref){const props=(0,useThemeProps.Z)({props:inProps,name:"MuiIconButton"}),{edge=!1,children,className,color="default",disabled=!1,disableFocusRipple=!1,size="medium"}=props,other=(0,objectWithoutPropertiesLoose.Z)(props,_excluded),ownerState=(0,esm_extends.Z)({},props,{edge,color,disabled,disableFocusRipple,size}),classes=(ownerState=>{const{classes,disabled,color,edge,size}=ownerState,slots={root:["root",disabled&&"disabled","default"!==color&&`color${(0,capitalize.Z)(color)}`,edge&&`edge${(0,capitalize.Z)(edge)}`,`size${(0,capitalize.Z)(size)}`]};return(0,composeClasses.Z)(slots,getIconButtonUtilityClass,classes)})(ownerState);return(0,jsx_runtime.jsx)(IconButtonRoot,(0,esm_extends.Z)({className:(0,clsx_m.Z)(classes.root,className),centerRipple:!0,focusRipple:!disableFocusRipple,disabled,ref,ownerState},other,{children}))}))},"./src/components/messaging/thread/queue/stories/QueuedAttachmentImage.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{QueuedAttachmentImage:()=>QueuedAttachmentImage,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={title:"components/messaging/queue",component:__webpack_require__("./src/components/messaging/thread/queue/QueuedAttachmentImage.tsx").H},QueuedAttachmentImage={args:{queueData:{file:new File(["https://iampava.com/images/pava.jpg"],"filename"),onRemove:()=>{}}}};QueuedAttachmentImage.parameters={...QueuedAttachmentImage.parameters,docs:{...QueuedAttachmentImage.parameters?.docs,source:{originalSource:'{\n  args: {\n    queueData: {\n      file: new File(["https://iampava.com/images/pava.jpg"], "filename"),\n      onRemove: () => {}\n    }\n  }\n}',...QueuedAttachmentImage.parameters?.docs?.source}}};const __namedExportsOrder=["QueuedAttachmentImage"]},"./src/components/icon/BorderedCloseIcon.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>BorderedCloseIcon});__webpack_require__("./node_modules/react/index.js");var _mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/SvgIcon/SvgIcon.js"),_mui_material_styles__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/styles/useTheme.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function BorderedCloseIcon(props){const theme=(0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_2__.Z)(),colorBackground="light"===theme.palette.mode?theme.palette.grey[700]:theme.palette.grey[300],colorSymbol="light"===theme.palette.mode?theme.palette.grey[200]:theme.palette.grey[700];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{...props,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("circle",{cx:"12",cy:"12",r:"8",fill:colorBackground}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"M12,2 C6.47,2 2,6.47 2,12 C2,17.53 6.47,22 12,22 C17.53,22 22,17.53 22,12 C22,6.47 17.53,2 12,2 Z M12,20 C7.59,20 4,16.41 4,12 C4,7.59 7.59,4 12,4 C16.41,4 20,7.59 20,12 C20,16.41 16.41,20 12,20 Z",fill:theme.palette.messageIncoming.main}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"M13.89,8.7 L12,10.59 L10.11,8.7 C9.72,8.31 9.09,8.31 8.7,8.7 C8.31,9.09 8.31,9.72 8.7,10.11 L10.59,12 L8.7,13.89 C8.31,14.28 8.31,14.91 8.7,15.3 C9.09,15.69 9.72,15.69 10.11,15.3 L12,13.41 L13.89,15.3 C14.28,15.69 14.91,15.69 15.3,15.3 C15.69,14.91 15.69,14.28 15.3,13.89 L13.41,12 L15.3,10.11 C15.69,9.72 15.69,9.09 15.3,8.7 C14.91,8.32 14.27,8.32 13.89,8.7 Z",fill:colorSymbol})]})}BorderedCloseIcon.displayName="BorderedCloseIcon";try{BorderedCloseIcon.displayName="BorderedCloseIcon",BorderedCloseIcon.__docgenInfo={description:"",displayName:"BorderedCloseIcon",props:{children:{defaultValue:null,description:"Node passed into the SVG element.",name:"children",required:!1,type:{name:"ReactNode"}},classes:{defaultValue:null,description:"Override or extend the styles applied to the component.",name:"classes",required:!1,type:{name:"(Partial<SvgIconClasses> & Partial<ClassNameMap<never>>)"}},color:{defaultValue:{value:"'inherit'"},description:"The color of the component.\nIt supports both default and custom theme colors, which can be added as shown in the\n[palette customization guide](https://mui.com/material-ui/customization/palette/#adding-new-colors).\nYou can use the `htmlColor` prop to apply a color attribute to the SVG element.",name:"color",required:!1,type:{name:"enum",value:[{value:'"action"'},{value:'"error"'},{value:'"inherit"'},{value:'"disabled"'},{value:'"primary"'},{value:'"secondary"'},{value:'"info"'},{value:'"success"'},{value:'"warning"'}]}},fontSize:{defaultValue:{value:"'medium'"},description:"The fontSize applied to the icon. Defaults to 24px, but can be configure to inherit font size.",name:"fontSize",required:!1,type:{name:"enum",value:[{value:'"small"'},{value:'"inherit"'},{value:'"large"'},{value:'"medium"'}]}},htmlColor:{defaultValue:null,description:"Applies a color attribute to the SVG element.",name:"htmlColor",required:!1,type:{name:"string"}},inheritViewBox:{defaultValue:{value:"false"},description:"If `true`, the root node will inherit the custom `component`'s viewBox and the `viewBox`\nprop will be ignored.\nUseful when you want to reference a custom `component` and have `SvgIcon` pass that\n`component`'s viewBox to the root node.",name:"inheritViewBox",required:!1,type:{name:"boolean"}},shapeRendering:{defaultValue:null,description:"The shape-rendering attribute. The behavior of the different options is described on the\n[MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/shape-rendering).\nIf you are having issues with blurry icons you should investigate this prop.",name:"shapeRendering",required:!1,type:{name:"string"}},sx:{defaultValue:null,description:"The system prop that allows defining system overrides as well as additional CSS styles.",name:"sx",required:!1,type:{name:"SxProps<Theme>"}},titleAccess:{defaultValue:null,description:"Provides a human-readable title for the element that contains it.\nhttps://www.w3.org/TR/SVG-access/#Equivalent",name:"titleAccess",required:!1,type:{name:"string"}},viewBox:{defaultValue:{value:"'0 0 24 24'"},description:'Allows you to redefine what the coordinates without units mean inside an SVG element.\nFor example, if the SVG element is 500 (width) by 200 (height),\nand you pass viewBox="0 0 50 20",\nthis means that the coordinates inside the SVG will go from the top left corner (0,0)\nto bottom right (50,20) and each unit will be worth 10px.',name:"viewBox",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: SVGSVGElement | null) => void) | RefObject<SVGSVGElement> | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icon/BorderedCloseIcon.tsx#BorderedCloseIcon"]={docgenInfo:BorderedCloseIcon.__docgenInfo,name:"BorderedCloseIcon",path:"src/components/icon/BorderedCloseIcon.tsx#BorderedCloseIcon"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/queue/QueuedAttachment.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>QueuedAttachment});__webpack_require__("./node_modules/react/index.js");var _icon_BorderedCloseIcon__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/icon/BorderedCloseIcon.tsx"),_mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/Tooltip/Tooltip.js"),_mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),_mui_material__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function QueuedAttachment(props){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_2__.Z,{title:props.queueData.file.name,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.Z,{sx:{width:64,height:64,position:"relative"},children:[props.children,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_4__.Z,{sx:{position:"absolute",top:0,right:0,transform:"translate(50%, -50%)"},onClick:props.queueData.onRemove,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_icon_BorderedCloseIcon__WEBPACK_IMPORTED_MODULE_5__.Z,{})})]})})}QueuedAttachment.displayName="QueuedAttachment";try{QueuedAttachment.displayName="QueuedAttachment",QueuedAttachment.__docgenInfo={description:"",displayName:"QueuedAttachment",props:{queueData:{defaultValue:null,description:"",name:"queueData",required:!0,type:{name:"QueuedAttachmentProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/queue/QueuedAttachment.tsx#QueuedAttachment"]={docgenInfo:QueuedAttachment.__docgenInfo,name:"QueuedAttachment",path:"src/components/messaging/thread/queue/QueuedAttachment.tsx#QueuedAttachment"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/messaging/thread/queue/QueuedAttachmentImage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>QueuedAttachmentImage});__webpack_require__("./node_modules/react/index.js");var _QueuedAttachment__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/messaging/thread/queue/QueuedAttachment.tsx"),shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/util/hookUtils.ts"),_mui_material__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@mui/material/esm/styles/styled.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const AttachmentImage=(0,_mui_material__WEBPACK_IMPORTED_MODULE_2__.ZP)("img")((({theme})=>({width:"100%",height:"100%",objectFit:"cover",borderRadius:theme.shape.borderRadius})));function QueuedAttachmentImage(props){const imageURL=(0,shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_3__.vf)(props.queueData.file,props.queueData.file.type);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_QueuedAttachment__WEBPACK_IMPORTED_MODULE_4__.Z,{queueData:props.queueData,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AttachmentImage,{src:imageURL,alt:""})})}QueuedAttachmentImage.displayName="QueuedAttachmentImage";try{QueuedAttachmentImage.displayName="QueuedAttachmentImage",QueuedAttachmentImage.__docgenInfo={description:"",displayName:"QueuedAttachmentImage",props:{queueData:{defaultValue:null,description:"",name:"queueData",required:!0,type:{name:"QueuedAttachmentProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/messaging/thread/queue/QueuedAttachmentImage.tsx#QueuedAttachmentImage"]={docgenInfo:QueuedAttachmentImage.__docgenInfo,name:"QueuedAttachmentImage",path:"src/components/messaging/thread/queue/QueuedAttachmentImage.tsx#QueuedAttachmentImage"})}catch(__react_docgen_typescript_loader_error){}},"./src/interface/people/peopleUtils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>AddressType,b:()=>PeopleNoPermissionError});let AddressType=function(AddressType){return AddressType.Email="email",AddressType.Phone="phone",AddressType}({});class PeopleNoPermissionError extends Error{}},"./src/state/peopleState.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>PeopleContext});var shared_interface_people_peopleUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/interface/people/peopleUtils.ts"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),shared_util_conversationUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/util/conversationUtils.ts"),libphonenumber_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/libphonenumber-js/min/exports/parsePhoneNumberFromString.js"),shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/util/hookUtils.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const PeopleContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({needsPermission:!1,getPerson:()=>{},allPeople:void 0});function PeopleContextProvider(props){const[needsPermission,setNeedsPermission]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[peopleData,setPeopleData]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(void 0),ready=props.ready;(0,shared_util_hookUtils__WEBPACK_IMPORTED_MODULE_2__.Ev)((addPromise=>{ready&&addPromise(async function gapiLoadPeople(){const personArray=[],contactMap=new Map;let nextPageToken,requestIndex=0;do{requestIndex>0&&requestIndex%2==0&&await new Promise((r=>setTimeout(r,1e3)));const parameters={resourceName:"people/me",personFields:"names,photos,emailAddresses,phoneNumbers",pageToken:nextPageToken,pageSize:1e3,sortOrder:"FIRST_NAME_ASCENDING",sources:["READ_SOURCE_TYPE_CONTACT"]};let response;try{response=await gapi.client.people.people.connections.list(parameters)}catch(error){const response=error;throw 401===response.status||403===response.status?new shared_interface_people_peopleUtils__WEBPACK_IMPORTED_MODULE_3__.b:new GAPIPeopleError(response)}if(!response.result.connections)break;for(const person of response.result.connections){const personData=googlePersonToPersonData(person);personArray.push(personData);for(const address of personData.addresses)contactMap.has(address.value)||contactMap.set(address.value,personData)}nextPageToken=response.result.nextPageToken,console.log("Loaded contacts request index "+requestIndex+" / "+nextPageToken),requestIndex++}while(nextPageToken);return{personArray,personMap:contactMap}}()).then(setPeopleData).catch((error=>{error instanceof shared_interface_people_peopleUtils__WEBPACK_IMPORTED_MODULE_3__.b?setNeedsPermission(!0):console.warn(`Failed to load people: ${error}`)}))}),[ready,setPeopleData]);const getPerson=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((address=>{if(void 0===peopleData)return;let formattedAddress=address;if(!address.includes("@")){const phone=(0,libphonenumber_js__WEBPACK_IMPORTED_MODULE_4__._)(address);void 0!==phone&&(formattedAddress=phone.number.toString())}return peopleData.personMap.get(formattedAddress)}),[peopleData]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PeopleContext.Provider,{value:{needsPermission,getPerson,allPeople:peopleData?.personArray},children:props.children})}PeopleContextProvider.displayName="PeopleContextProvider";class GAPIPeopleError extends Error{constructor(response){super(response.body),this.response=response}}function googlePersonToPersonData(person){const id=person.resourceName,name=person.names?.[0].displayName,avatar=person.photos?.[0]?.url;return{id,name,avatar,addresses:[...person.emailAddresses?.reduce(((accumulator,address)=>(void 0!==address.value&&accumulator.push({value:address.value,displayValue:address.value,label:address.formattedType,type:shared_interface_people_peopleUtils__WEBPACK_IMPORTED_MODULE_3__.D.Email}),accumulator)),[])??[],...person.phoneNumbers?.reduce(((accumulator,address)=>(void 0!==address.canonicalForm&&accumulator.push({value:address.canonicalForm,displayValue:(0,shared_util_conversationUtils__WEBPACK_IMPORTED_MODULE_5__.Tg)(address.canonicalForm),label:address.formattedType,type:shared_interface_people_peopleUtils__WEBPACK_IMPORTED_MODULE_3__.D.Phone}),accumulator)),[])??[]]}}try{PeopleContextProvider.displayName="PeopleContextProvider",PeopleContextProvider.__docgenInfo={description:"",displayName:"PeopleContextProvider",props:{ready:{defaultValue:null,description:"",name:"ready",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/state/peopleState.tsx#PeopleContextProvider"]={docgenInfo:PeopleContextProvider.__docgenInfo,name:"PeopleContextProvider",path:"src/state/peopleState.tsx#PeopleContextProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/util/hookUtils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ev:()=>useCancellableEffect,ZM:()=>useIsFaceTimeSupported,b8:()=>useUnsubscribeContainer,em:()=>usePersonName,fu:()=>useNonNullableCacheState,q3:()=>usePersonData,vU:()=>useConversationTitle,vf:()=>useBlobURL});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),shared_connection_connectionManager__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/connection/connectionManager.ts"),_conversationUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/util/conversationUtils.ts"),shared_state_peopleState__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/state/peopleState.tsx");function useBlobURL(data,type){const[imageURL,setImageURL]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(void 0);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const imageURL=URL.createObjectURL(new Blob([data],{type}));return setImageURL(imageURL),()=>{URL.revokeObjectURL(imageURL),setImageURL(void 0)}}),[data,type,setImageURL]),imageURL}function useNonNullableCacheState(...args){const initialState=args[0];let initialCacheState;initialCacheState=1===args.length?args[0]:args[1];const[value,setValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialState),[cacheValue,setCacheValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialCacheState),deferredValue=(0,react__WEBPACK_IMPORTED_MODULE_0__.useDeferredValue)(value);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{deferredValue&&setCacheValue(deferredValue)}),[deferredValue,setCacheValue]),[value,cacheValue,setValue]}function useCancellableEffect(effect,deps){(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{let isCancelled=!1;const cleanup=effect((promise=>new Promise(((resolve,reject)=>{promise.then((val=>!isCancelled&&resolve(val))).catch((error=>!isCancelled&&reject(error)))}))));return()=>{isCancelled=!0,cleanup?.()}}),deps)}function useUnsubscribeContainer(deps){const callbackCollection=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(new Set).current;return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>()=>{for(const unsubscribe of callbackCollection)unsubscribe();callbackCollection.clear()}),deps),callback=>{callbackCollection.add(callback)}}function useIsFaceTimeSupported(){const[isFaceTimeSupported,setIsFaceTimeSupported]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>(shared_connection_connectionManager__WEBPACK_IMPORTED_MODULE_1__.UB.subscribe(setIsFaceTimeSupported),()=>shared_connection_connectionManager__WEBPACK_IMPORTED_MODULE_1__.UB.unsubscribe(setIsFaceTimeSupported))),[setIsFaceTimeSupported]),isFaceTimeSupported}function useConversationTitle(conversation){const peopleState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(shared_state_peopleState__WEBPACK_IMPORTED_MODULE_2__.A);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>void 0!==conversation.name&&conversation.name.length>0?conversation.name:(0,_conversationUtils__WEBPACK_IMPORTED_MODULE_3__.As)(conversation.members,peopleState)),[conversation,peopleState])}function usePersonData(address){const peopleState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(shared_state_peopleState__WEBPACK_IMPORTED_MODULE_2__.A);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{if(void 0!==address)return peopleState.getPerson(address)}),[address,peopleState])}function usePersonName(address){return usePersonData(address)?.name??address}}}]);